function GetAnalyzeScript(e){return null==e?[]:"undefined"!=typeof e.meta?e.data:e}function setUsersFlowInfo(e,a){var t="",r="";if(null==a)for(var n=0;n<project.screensArray.length;n++){var s=project.screensArray[n];if(e.sid==s.id){t=s.Title,r=s.thumb_available?(screenResourcesURLPrefix+s.image).replace("screen-elements","screen-thumbs"):screenResourcesURLPrefix+s.image;break}}else for(var n=0;n<a.length;n++)if(e.sid==a[n].id){t=a[n].t,r=screenResourcesURLPrefix.replace("screen-elements","screen-thumbs")+a[n].i;for(var i=0;i<project.screensArray.length;i++){var s=project.screensArray[i];if(e.sid==s.id){t=s.Title;break}}break}e.title=t,e.image=r,e.ges="",e.trans=""}function setUsersFlowAdditionalInfo(e){for(var a=0;a<e.length;a++){for(var t=e[a].sessions,r=0;r<e[a].children.length;r++)t-=e[a].children[r].sessions;e[a].dropoffs=t,setUsersFlowAdditionalInfo(e[a].children)}}function GenerateAnalyzeDashboard(e,a,t){for(var r=0,n=0,s=0,i=0;i<e.analyze.length;i++){var o=GetAnalyzeScript(e.analyze[i].script);if(o.length>0){n+=o[o.length-1][0];for(var l=0;l<o.length;l++)o[l].length>6&&s++;e.analyze[i].has_script&&r++}}var d=0,c=0;if(a.find(".total-users .card-value.analyze-dashboard-value").text(r),r>0)var d=parseInt(n/r),c=parseInt(s/r);var h=0;if(isNaN(d)||(h=d>60?parseInt(d/60)+"m "+parseInt(d%60)+"s":d+"s"),a.find(".avg-time-spent .analyze-dashboard-value").text(h),a.find(".avg-interactions .analyze-dashboard-value").text(isNaN(c)?0:c),0==e.analyze.length||null==e.analyze[0].share_journey_date)a.find(".analyze-start-end > .analyze-dashboard-value").text("No user activity"),a.find(".analyze-active-for > .analyze-dashboard-value").text("No user activity");else{for(var v=new Date(e.analyze[0].share_journey_date.replace(/-/g,"/")+" UTC"),p=new Date(e.analyze[0].share_journey_date.replace(/-/g,"/")+" UTC"),i=e.analyze.length-1;i>=0;i--)if(null!=e.analyze[i].share_journey_date){p=new Date(e.analyze[i].share_journey_date.replace(/-/g,"/")+" UTC");break}var f=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],g=parseInt((v-p)/864e5);a.find(".analyze-active-for > .analyze-dashboard-value").text(g<2?"1 day":g+" days"),a.find(".analyze-start-end > .analyze-dashboard-value").text(p.getDate()+" "+f[p.getMonth()]+" - "+v.getDate()+" "+f[v.getMonth()])}GenerateMapTotalUsers(e,t),GenerateMapTotalUsers(e,t)}function GenerateMapTotalUsers(e,a){if(!(e.analyze.length<1)){for(var t=[],r=0,n=e.analyze.length-1;n>=0;n--){var s=GetAnalyzeScript(e.analyze[n].script);if(s.length>0){var i=new Date(e.analyze[n].share_journey_date.replace(/-/g,"/")+" UTC");if(r++,t.length>0&&parseInt((i-t[t.length-1][0])/864e5)<2)t[t.length-1][1]=r;else{var o=[i,r];t.push(o)}}}try{var l=new google.visualization.DataTable;l.addColumn("date","Date Of Testing"),l.addColumn("number","Total Users"),l.addRows(t);var d={title:"Total Validators",height:350,width:1200,colors:["#384957"],is3D:!1,pointSize:5,backgroundColor:"#fff",animation:{duration:1e3,easing:"out"},vAxis:{title:"Users"},hAxis:{title:"Reviewed On"}},c=new google.visualization.LineChart(document.getElementById(a));c.draw(l,d)}catch(e){}}}function GenerateMapAvgTimeSpent(e,a){if(!(e.analyze.length<1)){for(var t=[],r=0,n=0,s=e.analyze.length-1;s>=0;s--){var i=GetAnalyzeScript(e.analyze[s].script);if(i.length>0){var o=new Date(e.analyze[s].share_journey_date.replace(/-/g,"/")+" UTC");if(r++,n+=i[i.length-1][0],t.length>0&&parseInt((o-t[t.length-1][0])/864e5)<2)t[t.length-1][1]=parseInt(n/r);else{var l=[o,parseInt(n/r)];t.push(l)}}}try{var d=new google.visualization.DataTable;d.addColumn("date","Date Of Testing"),d.addColumn("number","Avg Time Spent (In Seconds)"),d.addRows(t);var c={title:"Avg Time Spent",height:350,width:1200,colors:["#384957"],is3D:!0,pointSize:5,backgroundColor:"#fff",vAxis:{title:"Time Spent (seconds)"},hAxis:{title:"Reviewed On"}},h=new google.visualization.LineChart(document.getElementById(a));h.draw(d,c)}catch(e){}}}function GenerateMapAvgInteraction(e,a){if(!(e.analyze.length<1)){for(var t=new Array,r=0,n=0,s=e.analyze.length-1;s>=0;s--){var i=GetAnalyzeScript(e.analyze[s].script);if(i.length>0){var o=new Date(e.analyze[s].share_journey_date.replace(/-/g,"/")+" UTC");r++;for(var l=0;l<i.length;l++)i[l].length>6&&n++;if(t.length>0&&parseInt((o-t[t.length-1][0])/864e5)<2)t[t.length-1][1]=parseInt(n/r);else{var d=[o,parseInt(n/r)];t.push(d)}}}try{var c=new google.visualization.DataTable;c.addColumn("date","Date Of Testing"),c.addColumn("number","Avg. Interactions"),c.addRows(t);var h={title:"Avg. Interactions",height:350,width:1200,colors:["#384957"],is3D:!0,pointSize:5,backgroundColor:"#fff",vAxis:{title:"Avg. Interactions"},hAxis:{title:"Reviewed On"}},v=new google.visualization.LineChart(document.getElementById(a));v.draw(c,h)}catch(e){}}}function ShowcaseUserJourney(e,a,t,r){var n="",s=[],i=null;void 0!=a.meta&&(i=a.meta,a=a.data),s.push([a[0][1],0,a[0][8]]);for(var o=0;o<a.length;o++)s.length>0&&"screen"==a[o][9]&&a[o][7]!=a[o][1]&&s.push([a[o][7],a[o][0],a[o][8]]);for(var o=0;o<s.length;o++){var l="",d=s[o][0],c="";if(null!=i){for(var h=0;h<i.length;h++)if(i[h].id==d){l=screenResourcesURLPrefix+i[h].i,c=i[h].t;break}}else for(var h=0;h<project.screensArray.length;h++)if(project.screensArray[h].id==d){l=project.screensArray[h].thumb_available?(screenResourcesURLPrefix+project.screensArray[h].image).replace("screen-elements","screen-thumbs"):screenResourcesURLPrefix+project.screensArray[h].image,c=project.screensArray[h].Title;break}l.length>0&&(n+="<div class='userflow-container' data-duration='"+s[o][1]+"' data-transition='"+s[o][1]+"'><div class='"+e+"cf-spinner small' data-id='"+d+"'><svg class='spinner' width='40px' height='40px' viewBox='0 0 66 66' xmlns='http://www.w3.org/2000/svg'><circle class='path' fill='none' stroke-width='6' stroke-linecap='round' cx='33' cy='33' r='30'></circle></svg></div><canvas id='"+e+"UserFlowCanvasContainer-"+d+"' class='userTestUserFlowCanvasContainer'></canvas><div><img data-id='"+d+"' class='userflow-screen' src='"+l+"'/></div><p class='userflow-title'>"+c+"</p></div>")}var v=t.find(">div");v.scrollTop(0),v.html(n);var n=t.find(".userflow-container");try{for(var p=125,f=100,g=deviceHeight*(125/deviceWidth),u=v.width(),m=u/p,w=Math.floor(m),y=0;y<f;){var z=u-w*p;y=Math.floor(z/(w-1)),y<f&&(w-=1)}n.css({width:p,height:g});for(var b=0,o=0;o<n.length;o++){var T=!0;o%w==0&&(b++,b%2==0&&($(n[o]).css("marginRight",0),T=!1)),o%w==w-1&&b%2!=0&&($(n[o]).css("marginRight",0),T=!1),T&&$(n[o]).css("marginRight",y),b%2==0?$(n[o]).css("float","right"):$(n[o]).css("float","left")}for(var o=1;o<n.length;o++){var A=$(n[o-1]),C=$(n[o]),I=A.outerWidth()/2,x=A.outerHeight()/2,R=C.outerWidth()/2,M=C.outerHeight()/2,U=A.position().left+I,S=A.position().top+x,D=C.position().left+R,j=C.position().top+M,k=0,_=Math.sqrt(Math.pow(D-U,2)+Math.pow(j-S,2)),F=180/Math.PI*Math.acos((j-S)/_);D>U&&(F*=-1),F>-135&&F<=-45?(U+=I,D-=R,k=U,$("<div class='userflow-arrow-tip right'></div>").css({left:D-10,top:j-2}).appendTo(v)):F>45&&F<=135?(U-=I,D+=R,k=D,$("<div class='userflow-arrow-tip left'></div>").css({left:D+10,top:j+2}).appendTo(v)):F>135||F<=135?(S+=x,j-=M,k=U,$("<div class='userflow-arrow-tip bottom'></div>").css({left:U+2,top:j-10}).appendTo(v)):F>-45&&F<=45&&(S-=x,j+=M,k=U,$("<div class='userflow-arrow-tip bottom'></div>").css({left:S+10,top:j-2}).appendTo(v)),_=Math.sqrt(Math.pow(D-U,2)+Math.pow(j-S,2))-5,F=180/Math.PI*Math.acos((j-S)/_),D>U&&(F*=-1),$("<div class='userflow-arrow'></div>").css({left:U,top:S,height:_,"-webkit-transform":"rotate("+F+"deg)","-moz-transform":"rotate("+F+"deg)","-o-transform":"rotate("+F+"deg)","-ms-transform":"rotate("+F+"deg)",transform:"rotate("+F+"deg)"}).appendTo(v);var H=(parseFloat(C.attr("data-duration"))-parseFloat(A.attr("data-duration"))).toFixed(1),P=A.attr("data-transition");switch(P){case"fadeIn":P="Fade";break;case"left":P="Push Left";break;case"right":P="Push Right";break;case"top":P="Push Up";break;case"bottom":P="Push Down";break;case"flipRight":P="Flip Right";break;default:P="No transition"}$("<div class='userflow-details'><div class='userflow-duration'><svg fill='#333333' height='16' viewBox='0 0 24 24' width='16' style='vertical-align:middle;' xmlns='http://www.w3.org/2000/svg'><path d='M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z'/><path d='M0 0h24v24H0z' fill='none'/><path d='M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z'/></svg> Time spent<br> <b>"+H+" sec</b></div></div>").css({left:k,top:S+5,width:125}).appendTo(v)}"function"==typeof r&&r(p)}catch(e){}}function drawUserFlowHeatMap(e,a,t,r,n){for(var s=[],i=r/parseInt(project.width),o=0;o<n.length;o++)n[o].length>6&&n[o][1]==t&&0!=n[o][3]&&0!=n[o][4]&&s.push([parseInt(n[o][3])*i,parseInt(n[o][4])*i,1]);var l=$("#"+e+"UserFlowCanvasContainer-"+t).hide();l.attr("width",r).attr("height",a.parent().height()).show();try{var d=1,c=simpleheat(e+"UserFlowCanvasContainer-"+t).data(s).max(d);c.radius(15,0),c.draw(),$(".userflow-container ."+e+"cf-spinner[data-id='"+t+"']").hide()}catch(e){}}function isUserScriptExits(e,a){var t=e.some(function(e){return e.share_invitee===parseInt(a)});return!!t}function getTimeFormat(e){e=Math.floor(e);var a=parseInt(e/60),t=e%60;return a+":"+(t<10?"0"+t:t)}function userTestingZoomSliderInit(e){var a=150,t=900;"Landscape"!=project.orientation&&"Desktop (Web)"!==device&&"Desktop Widescreen (Web)"!==device||(a=200),$(".userTestingZoomSlider .cf-slider").slider({orientation:"horizontal",range:"min",value:e,min:a,max:t,step:10,change:function(e,a){$(this).hasClass("tbt")?ResizeHeatmapThumbnails($("#userTestHeatmapScreenContainer > li"),a.value,900):ResizeHeatmapThumbnails($("#heatmapScreenContainer > li"),a.value,900)},slide:function(e,a){$(this).hasClass("tbt")?ResizeHeatmapThumbnails($("#userTestHeatmapScreenContainer > li"),a.value,900):ResizeHeatmapThumbnails($("#heatmapScreenContainer > li"),a.value,900)}})}function ResizeHeatmapThumbnails(e,a,t){try{for(var r=a,n=15,s=deviceHeight*(a/deviceWidth),i=t/r,o=i<=1?1:Math.floor(i),l=0;l<n&&o>0;){var d=t-o*r;l=Math.floor(d/o),o-=1}o+=1,e.each(function(){$(this).css({width:r,height:s,marginRight:l}),$(this).find("div").css({width:"100%"})})}catch(e){}}